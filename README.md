# ðŸŒˆ ì´ë¯¸ì§€ ìƒ‰ìƒí™” ë° ì†ì‹¤ ë¶€ë¶„ ë³µì› AI ê²½ì§„ëŒ€íšŒ
![image](https://github.com/user-attachments/assets/f297bed5-d06d-46d0-a70d-a3dea0b98e6f)
---
## ðŸ“Œ ëŒ€íšŒ ì†Œê°œ
> **"ì†ì‹¤ëœ ì´ë¯¸ì§€ë¥¼ ë³µêµ¬í•˜ê³  í‘ë°± ì´ë¯¸ì§€ë¥¼ ì»¬ëŸ¬í™”í•˜ëŠ” AI ì•Œê³ ë¦¬ì¦˜ ê°œë°œ!"**  
ì´ ê¸°ìˆ ì€ ì—­ì‚¬ì  ì‚¬ì§„ ë³µì›, ì˜ìƒ íŽ¸ì§‘, ì˜ë£Œ ì´ë¯¸ì§€ ë³µêµ¬ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ í™œìš©ë©ë‹ˆë‹¤.
"ì´ë¯¸ì§€ ìƒ‰ìƒí™” ë° ì†ì‹¤ ë¶€ë¶„ ë³µì› AI ê²½ì§„ëŒ€íšŒ"ëŠ” ì†ìƒë˜ê±°ë‚˜ ê²°ì†ëœ ì´ë¯¸ì§€ë¥¼ ë³µêµ¬í•˜ê³ , í‘ë°± ì´ë¯¸ì§€ë¥¼ ìžì—°ìŠ¤ëŸ¬ìš´ ì»¬ëŸ¬ ì´ë¯¸ì§€ë¡œ ë³€í™˜í•˜ëŠ” AI ê¸°ìˆ ì„ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

ì´ í”„ë¡œì íŠ¸ëŠ” í‘ë°± ë° ì†ì‹¤ëœ ì´ë¯¸ì§€ë¥¼ ë³µêµ¬í•˜ì—¬ ì›ë³¸ê³¼ ìµœëŒ€í•œ ìœ ì‚¬í•˜ê²Œ ë§Œë“œëŠ” AI ëª¨ë¸ì„ ê°œë°œí•˜ëŠ” ë° ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.

---

### ðŸ“‚ **ë°ì´í„°ì…‹ ì •ë³´**
| ë°ì´í„° ìœ í˜•    | ì„¤ëª…                                        |
|----------------|-------------------------------------------|
| `train_input`  | ì†ì‹¤ëœ í‘ë°± ì´ë¯¸ì§€ (29603ìž¥)               |
| `train_gt`     | ì›ë³¸ ì»¬ëŸ¬ ì´ë¯¸ì§€ (29603ìž¥)                |
| `train.csv`    | `train_input`ê³¼ `train_gt`ì˜ Pair ì •ë³´     |
| `test_input`   | ì†ì‹¤ëœ í‘ë°± ì´ë¯¸ì§€ (100ìž¥)                |
| `test.csv`     | í‰ê°€ìš© ì´ë¯¸ì§€ ê²½ë¡œ ì •ë³´                   |

### ðŸ† **ëŒ€íšŒ ëª©í‘œ**
1. ì†ì‹¤ëœ ì´ë¯¸ì§€ì˜ íŠ¹ì • ì˜ì—­ ë³µêµ¬  
2. í‘ë°± ì´ë¯¸ì§€ë¥¼ ìžì—°ìŠ¤ëŸ¬ìš´ ì»¬ëŸ¬ ì´ë¯¸ì§€ë¡œ ë³€í™˜  

### ðŸ“ **í‰ê°€ ê¸°ì¤€**
- **SSIM**: ì´ë¯¸ì§€ êµ¬ì¡°ì˜ ìœ ì‚¬ë„
- **ìƒ‰ìƒ ížˆìŠ¤í† ê·¸ëž¨ ìœ ì‚¬ë„**: ìƒ‰ìƒ ì •ë³´ì˜ ìœ ì‚¬ë„
---

## ðŸš€ **í”„ë¡œì íŠ¸ êµ¬ì¡°**
```plaintext
repository/
â”œâ”€â”€ data/                   # ë°ì´í„° ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ train_input/        # í•™ìŠµìš© í‘ë°± ì´ë¯¸ì§€ (ì†ì‹¤ í¬í•¨)
â”‚   â”œâ”€â”€ train_gt/           # í•™ìŠµìš© ì›ë³¸ ì´ë¯¸ì§€
â”‚   â”œâ”€â”€ test_input/         # í‰ê°€ìš© í‘ë°± ì´ë¯¸ì§€
â”‚   â”œâ”€â”€ train.csv           # í•™ìŠµìš© ë°ì´í„° Pair ì •ë³´
â”‚   â””â”€â”€ test.csv            # í‰ê°€ìš© ë°ì´í„° ì •ë³´
â”œâ”€â”€ notebooks/              # ë…¸íŠ¸ë¶ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ EDA.ipynb           # ë°ì´í„° íƒìƒ‰ ë° ë¶„ì„ (EDA)
â”‚   â””â”€â”€ model_training.ipynb # ëª¨ë¸ í•™ìŠµ ë° ê²€ì¦ ì½”ë“œ
â”œâ”€â”€ src/                    # ì†ŒìŠ¤ ì½”ë“œ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ data_loader.py      # ë°ì´í„° ë¡œë”
â”‚   â”œâ”€â”€ model.py            # ëª¨ë¸ ì •ì˜
â”‚   â”œâ”€â”€ train.py            # í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ inference.py        # ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ results/                # ê²°ê³¼ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ predictions/        # ì¶”ë¡  ê²°ê³¼ ì €ìž¥
â”‚   â”œâ”€â”€ submission.zip      # ì œì¶œìš© íŒŒì¼
â”‚   â””â”€â”€ best_checkpoint/    # ìµœì  ëª¨ë¸ ì €ìž¥
â”‚       â””â”€â”€ best_model.pth  # ìµœì  ëª¨ë¸ íŒŒì¼
â”œâ”€â”€ README.md               # ë¦¬í¬ì§€í† ë¦¬ ì„¤ëª… íŒŒì¼
â”œâ”€â”€ requirements.txt        # ì˜ì¡´ì„± íŒŒì¼
â””â”€â”€ LICENSE                 # ë¼ì´ì„ ìŠ¤ íŒŒì¼
```
---

---

## ë°ì´í„° ì „ì²˜ë¦¬ ì„¤ëª…

### ðŸ› ï¸ **ì£¼ìš” ê¸°ëŠ¥**
1. **ì´ë¯¸ì§€ íŠ¹ì§• ì¶”ì¶œ**  
   - `CLIPProcessor` ë° `CLIPModel`ì„ ì‚¬ìš©í•˜ì—¬ ê³ ì°¨ì› ì´ë¯¸ì§€ íŠ¹ì§• ë²¡í„° ìƒì„±
2. **íŠ¹ì§• ë²¡í„° ì •ê·œí™”**  
   - ë²¡í„°ë¥¼ ì •ê·œí™”í•˜ì—¬ ë°ì´í„° ê°„ ê· ì¼ì„±ì„ ë³´ìž¥
3. **ì°¨ì› ì¶•ì†Œ ë° ì‹œê°í™”**  
   - **UMAP**ì„ í™œìš©í•˜ì—¬ 2ì°¨ì›ìœ¼ë¡œ ì¶•ì†Œ í›„ ì‹œê°í™”
4. **í´ëŸ¬ìŠ¤í„°ë§**  
   - **HDBSCAN** ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ë§ ë° ë…¸ì´ì¦ˆ ì œê±°
5. **ê²°ê³¼ ì €ìž¥**  
   - `train_preproc.csv`ì™€ `test_preproc.csv`ë¡œ ì €ìž¥

### ðŸ“Š **ê²°ê³¼ í™œìš©**
- ê°™ì€ ìž¥ì†Œì—ì„œ ì´¬ì˜ëœ ì‚¬ì§„ ë¬¶ìŒì˜ íŠ¹ì§•ì„ íš¨ê³¼ì ìœ¼ë¡œ ì¶”ì¶œí•˜ê³ , ë°ì´í„°ì˜ êµ¬ì¡°ì  ê´€ê³„ë¥¼ ì‹œê°í™”.
- ì „ì²˜ë¦¬ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•™ìŠµì— ì í•©í•œ ë°ì´í„°ì…‹ êµ¬ì¶•.

---
## í•™ìŠµ ì½”ë“œ ì„¤ëª…

### ðŸ› ï¸ **ì£¼ìš” ê¸°ëŠ¥ ë° ì‚¬ìš© ì´ìœ **
#### **1. ë°ì´í„° ì²˜ë¦¬**
| ê¸°ëŠ¥                          | ì„¤ëª…                                                                                 |
|-------------------------------|--------------------------------------------------------------------------------------|
| ì†ì‹¤ ì˜ì—­ ë§ˆìŠ¤í‚¹               | í•™ìŠµ ë°ì´í„°ì˜ ì†ì‹¤ëœ ì˜ì—­ì„ ìƒì„±í•˜ì—¬ ë³µì› í•™ìŠµì— í™œìš©                                |
| ë°ì´í„° ì¦ê°•                   | ëžœë¤ í´ë¦¬ê³¤ ê¸°ë°˜ ì†ì‹¤ íŒ¨í„´ ìƒì„± ë° ë³€í™˜ ì ìš©                                         |
| K-Fold êµì°¨ ê²€ì¦               | ë°ì´í„°ì…‹ì„ í•™ìŠµ ë° ê²€ì¦ ì„¸íŠ¸ë¡œ ë‚˜ëˆ„ì–´ ì¼ë°˜í™” ì„±ëŠ¥ì„ ê°•í™”                              |

ì‚¬ìš© ì´ìœ :
ë™ì¼í•œ ìž¥ì†Œì—ì„œ ì´¬ì˜ëœ ë°ì´í„°ì…‹ì˜ íŠ¹ì„±ì„ ê³ ë ¤í•˜ì—¬ ë¶ˆì™„ì „ ì˜ì—­ì„ ì •ì˜í•˜ê³  ì´ë¥¼ í•™ìŠµ ë°ì´í„°ë¡œ í™œìš©.
êµì°¨ ê²€ì¦ì„ í†µí•´ ë°ì´í„°ì…‹ì˜ ì¼ë°˜í™”ë¥¼ ê°•í™”í•˜ê³  ê³¼ì í•©ì„ ë°©ì§€.

#### **2. ëª¨ë¸ ì •ì˜**
| ê¸°ëŠ¥                          | ì„¤ëª…                                                                                 |
|-------------------------------|--------------------------------------------------------------------------------------|
| í‘ë°± ë³µì› ëª¨ë¸ (U-Net)         | ì†ì‹¤ëœ í‘ë°± ì´ë¯¸ì§€ë¥¼ ë³µì›                                                          |
| ì»¬ëŸ¬í™” ëª¨ë¸ (U-Net)            | ë³µì›ëœ í‘ë°± ì´ë¯¸ì§€ë¥¼ ìžì—°ìŠ¤ëŸ¬ìš´ ì»¬ëŸ¬ ì´ë¯¸ì§€ë¡œ ë³€í™˜                                  |

ì‚¬ìš© ì´ìœ :
Unet ì•„í‚¤í…ì²˜ëŠ” ì„¸ê·¸ë©˜í…Œì´ì…˜ ë° ë³µì› ìž‘ì—…ì— ë„ë¦¬ ì‚¬ìš©ë˜ë©°, í”½ì…€ ë‹¨ìœ„ì˜ ì •í™•í•œ ë³µêµ¬ì— ì í•©.
ë‘ ë‹¨ê³„ë¥¼ ë‚˜ëˆ„ì–´ ìž‘ì—…í•¨ìœ¼ë¡œì¨ ê°ê°ì˜ ë³µì› ë° ìƒ‰ìƒí™” ìž‘ì—…ì˜ ì„±ëŠ¥ì„ ìµœì í™”.

#### **3. ì†ì‹¤ í•¨ìˆ˜ ë° í‰ê°€ ì§€í‘œ**
| ì†ì‹¤ í•¨ìˆ˜                    | ì„¤ëª…                                                                                 |
|------------------------------|--------------------------------------------------------------------------------------|
| L1 ë° MSE ì†ì‹¤               | í”½ì…€ ë‹¨ìœ„ ë³µì› ì†ì‹¤ì„ ì¸¡ì •                                                         |

| í‰ê°€ ì§€í‘œ                    | ì„¤ëª…                                                                                 |
|------------------------------|--------------------------------------------------------------------------------------|
| SSIM                         | ë³µì›ëœ ì´ë¯¸ì§€ì™€ ì›ë³¸ì˜ êµ¬ì¡°ì  ìœ ì‚¬ì„±                                               |
| Masked SSIM                  | ì†ì‹¤ ì˜ì—­ì— ëŒ€í•œ SSIM                                                              |
| ížˆìŠ¤í† ê·¸ëž¨ ìœ ì‚¬ë„             | ìƒ‰ìƒ ì •ë³´ì˜ ìœ ì‚¬ë„                                                                 |

ì‚¬ìš© ì´ìœ :
í‰ê°€ ì§€í‘œë¥¼ í†µí•©í•˜ì—¬ ì¢…í•©ì ì¸ ëª¨ë¸ ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§.

#### **4. í•™ìŠµ ë° ê²€ì¦ ê³¼ì •**
| ê¸°ëŠ¥                          | ì„¤ëª…                                                                                 |
|-------------------------------|--------------------------------------------------------------------------------------|
| PyTorch Lightning ì‚¬ìš©        | í•™ìŠµ ë£¨í”„ë¥¼ ê°„ì†Œí™”í•˜ê³  ê°€ë…ì„±ì„ ë†’ìž„                                                |
| Early Stopping ë° Checkpoint  | í•™ìŠµ ì•ˆì •ì„± í™•ë³´ ë° ìµœì  ëª¨ë¸ ì €ìž¥                                                  |

ì‚¬ìš© ì´ìœ :
PyTorch Lightningì€ í•™ìŠµ ì½”ë“œì˜ ê°€ë…ì„±ì„ ë†’ì´ê³ , ë³µìž¡í•œ í•™ìŠµ ë£¨í”„ë¥¼ ê°„ì†Œí™”.
Early Stoppingìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ê³¼ì í•© ë°©ì§€ ë° í•™ìŠµ íš¨ìœ¨ì„±ì„ ë†’ìž„.

#### **5. ëª¨ë¸ ì˜ˆì¸¡ ë° ê²°ê³¼ ì €ìž¥**
| ê¸°ëŠ¥                          | ì„¤ëª…                                                                                 |
|-------------------------------|--------------------------------------------------------------------------------------|
| PNG ì´ë¯¸ì§€ ì €ìž¥               | í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•œ ë³µì› ê²°ê³¼ë¥¼ PNG íŒŒì¼ë¡œ ì €ìž¥                                     |
| ZIP íŒŒì¼ ì••ì¶•                 | ì œì¶œ ìš”êµ¬ ì‚¬í•­ì— ë§žì¶° ê²°ê³¼ë¥¼ ZIP íŒŒì¼ë¡œ ì••ì¶•                                         |

---

## ëª¨ë¸ ì„¤ëª…: U-Netê³¼ ResNet-34
### 1. U-Net ëª¨ë¸
ëª¨ë¸ êµ¬ì¡°:
U-Netì€ **ì¸ì½”ë”(Encoder)**ì™€ **ë””ì½”ë”(Decoder)**ë¡œ êµ¬ì„±ëœ ëŒ€ì¹­í˜• êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìžˆìŠµë‹ˆë‹¤.

ì¸ì½”ë”: ìž…ë ¥ ì´ë¯¸ì§€ë¥¼ ì••ì¶•í•˜ì—¬ ê³ ì°¨ì› íŠ¹ì§•ì„ ì¶”ì¶œ.

ë””ì½”ë”: ì¸ì½”ë”ì—ì„œ ì¶”ì¶œëœ íŠ¹ì§•ì„ ê¸°ë°˜ìœ¼ë¡œ ì›ëž˜ í•´ìƒë„ì˜ ì´ë¯¸ì§€ë¥¼ ë³µì›.
í”½ì…€ ë‹¨ìœ„ ë³µì›:
U-Netì€ í”½ì…€ ë‹¨ìœ„ì˜ ë³µì› ìž‘ì—…ì— ìµœì í™”ë˜ì–´ ìžˆìœ¼ë©°, ì˜ë£Œ ì˜ìƒ ë° ì´ë¯¸ì§€ ë³µì› ë¶„ì•¼ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë©ë‹ˆë‹¤.

ìŠ¤í‚µ ì—°ê²°(Skip Connections):
ì¸ì½”ë”ì˜ ì¤‘ê°„ ì¶œë ¥ì„ ë””ì½”ë”ì— ì§ì ‘ ì—°ê²°í•˜ì—¬, ì›ë³¸ ì´ë¯¸ì§€ì˜ ì„¸ë¶€ ì •ë³´ë¥¼ ë³µêµ¬í•˜ëŠ” ë° ìœ ë¦¬í•©ë‹ˆë‹¤.

ì†ì‹¤ ì˜ì—­ ë³µì›:
ì†ì‹¤ëœ ì´ë¯¸ì§€ì˜ íŠ¹ì • ì˜ì—­ ë³µêµ¬ ë° ì „ì²´ ì´ë¯¸ì§€ ìƒ‰ìƒí™”ì™€ ê°™ì€ ìž‘ì—…ì— ì í•©í•©ë‹ˆë‹¤.

### 2. ResNet-34 ë°±ë³¸
ëª¨ë¸ êµ¬ì¡°:
ResNet-34ëŠ” Residual Neural Network ê³„ì—´ì˜ ëª¨ë¸ë¡œ, ê¹Šì€ ì‹ ê²½ë§ì—ì„œë„ ì„±ëŠ¥ ì €í•˜ ì—†ì´ í•™ìŠµí•  ìˆ˜ ìžˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
Residual Block: ìž…ë ¥ì„ ì¶œë ¥ìœ¼ë¡œ ì§ì ‘ ì—°ê²°í•˜ëŠ” ìŠ¤í‚µ ì—°ê²°ì´ í¬í•¨ë˜ì–´ ìžˆì–´, ê¸°ìš¸ê¸° ì†Œì‹¤ ë¬¸ì œë¥¼ ì™„í™”.

íš¨ìœ¨ì ì¸ íŠ¹ì§• ì¶”ì¶œ:
ResNet-34ëŠ” ìƒëŒ€ì ìœ¼ë¡œ ê°€ë²¼ìš´ ë„¤íŠ¸ì›Œí¬ì´ê¸°ì— ë¹ ë¥¸ í•™ìŠµê³¼ ê°•ë ¥í•œ íŠ¹ì§• ì¶”ì¶œ ì„±ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

ì‚¬ì „ í•™ìŠµëœ ê°€ì¤‘ì¹˜:
ImageNet ë°ì´í„°ì…‹ìœ¼ë¡œ ì‚¬ì „ í•™ìŠµëœ ê°€ì¤‘ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í•™ìŠµ ì†ë„ë¥¼ ê°€ì†í™”í•˜ê³  ì´ˆê¸° ì„±ëŠ¥ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.

U-Netì˜ ì¸ì½”ë” ê°•í™”:
ResNet-34ë¥¼ U-Netì˜ ì¸ì½”ë”ë¡œ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ìž…ë ¥ ì´ë¯¸ì§€ì—ì„œ ë” ê¹Šê³  ì˜ë¯¸ ìžˆëŠ” íŠ¹ì§•ì„ ì¶”ì¶œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### 3. ëª¨ë¸ êµ¬ì„±
ì²« ë²ˆì§¸ U-Net (í‘ë°± ì´ë¯¸ì§€ ë³µì›):

ìž…ë ¥: ì†ì‹¤ëœ í‘ë°± ì´ë¯¸ì§€.
ì¶œë ¥: ë³µì›ëœ í‘ë°± ì´ë¯¸ì§€.
êµ¬ì¡°: ResNet-34 ë°±ë³¸ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì½”ë”ì˜ íŠ¹ì§• ì¶”ì¶œ ì„±ëŠ¥ ê°•í™”.

ë‘ ë²ˆì§¸ U-Net (ì»¬ëŸ¬í™”):

ìž…ë ¥: ë³µì›ëœ í‘ë°± ì´ë¯¸ì§€.
ì¶œë ¥: ì»¬ëŸ¬í™”ëœ ì´ë¯¸ì§€.
êµ¬ì¡°: ë™ì¼í•œ ResNet-34 ë°±ë³¸ì„ ì‚¬ìš©.


### 4. ì‚¬ìš©í•œ PyTorch ë¼ì´ë¸ŒëŸ¬ë¦¬
Segmentation Models PyTorch (SMP)
SMPëŠ” ì‚¬ì „ í•™ìŠµëœ ë°±ë³¸ê³¼ ë‹¤ì–‘í•œ ì„¸ê·¸ë©˜í…Œì´ì…˜ ì•„í‚¤í…ì²˜(U-Net, FPN ë“±)ë¥¼ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìžˆë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.
U-Netê³¼ ResNet-34 ë°±ë³¸ì„ ë¹ ë¥´ê²Œ í†µí•©í•˜ì—¬ í•™ìŠµì— í™œìš©.

###### ðŸ“‚ SMP êµ¬ì¡° ë‹¤ì´ì–´ê·¸ëž¨
```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pre-trained  â”‚
â”‚ Backbone     â”‚â—€â”€â”€ ResNet-34 (ImageNet)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Encoder     â”‚
â”‚  (Extract    â”‚
â”‚  Features)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Decoder     â”‚
â”‚  (Rebuild    â”‚
â”‚  Image)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---
![TEST_017](https://github.com/user-attachments/assets/b2a2af87-ef66-4aef-a4c7-2f4c5e4450bf)
->
![TEST_017](https://github.com/user-attachments/assets/d0603c48-ae72-4ce1-b404-3288831056c8)
